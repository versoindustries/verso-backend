{% extends "base.html" %}

{% block title %}Verso Backend: The Sovereign Monolith{% endblock %}

{% block description %}
Verso Backend is the Sovereign Monolith Protocol: a Python/SQL stack that ships finished HTML, rejects the Complexity Tax, and runs comfortably on a $5–$20 VPS.
{% endblock %}

{% block additional_css %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock %}

{% block head %}
<meta name="description" content="{{ description |e }}">
<meta name="keywords" content="Flask, Verso Backend, web development, Python, scalable applications, secure backend">
<meta property="og:title" content="{{ title |e }}">
<meta property="og:description" content="{{ description |e }}">
<meta property="og:image" content="{{ url_for('static', filename='images/logo.png') }}">
<meta property="og:url" content="{{ request.url }}">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ title |e }}">
<meta name="twitter:description" content="{{ description |e }}">
<meta name="twitter:image" content="{{ url_for('static', filename='images/logo.png') }}">
<link rel="canonical" href="{{ request.url }}">
<meta name="robots" content="index, follow">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ title |e }}",
  "description": "{{ description |e }}",
  "url": "{{ request.url }}"
}
</script>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightbox-img');
      const lightboxClose = document.querySelector('.lightbox-close');

      function attachLightboxListeners(links) {
          links.forEach(link => {
              link.addEventListener('click', function (event) {
                  event.preventDefault();
                  lightbox.style.display = 'flex';
                  lightboxImg.src = this.href;
              });
          });
      }

      const initialLinks = document.querySelectorAll('.gallery-container a');
      attachLightboxListeners(initialLinks);

      lightboxClose.addEventListener('click', function () {
          lightbox.style.display = 'none';
      });

      lightbox.addEventListener('click', function (event) {
          if (event.target !== lightboxImg) {
              lightbox.style.display = 'none';
          }
      });

      const lazyLoad = (image) => {
          image.src = image.dataset.src;
          image.onload = () => {
              image.classList.add('lazy-loaded');
          };
      };

      const observer = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
              if (entry.isIntersecting) {
                  lazyLoad(entry.target);
                  observer.unobserve(entry.target);
              }
          });
      });

      document.querySelectorAll('img.lazy').forEach(image => {
          observer.observe(image);
      });

      const loadMoreButton = document.getElementById('load-more');
      if (loadMoreButton) {
          loadMoreButton.addEventListener('click', function () {
              const page = this.getAttribute('data-page');
              fetch(`{{ url_for('main_routes.index') }}?page=${page}`)
                  .then(response => response.text())
                  .then(data => {
                      const parser = new DOMParser();
                      const doc = parser.parseFromString(data, 'text/html');
                      const newLinks = doc.querySelectorAll('#gallery-container a');
                      const hasMore = doc.querySelector('#load-more');

                      newLinks.forEach(link => {
                          document.getElementById('gallery-container').appendChild(link);
                          const img = link.querySelector('img.lazy');
                          observer.observe(img);
                      });

                      attachLightboxListeners(newLinks);

                      if (hasMore) {
                          this.setAttribute('data-page', parseInt(page) + 1);
                      } else {
                          this.remove();
                      }
                  });
          });
      }
  });
</script>
{% endblock %}

{% block content %}
<div class="section-spacer"></div>

<section id="hero-image" class="hero-section" role="banner">
  <div class="image-container">
    <img src="{{ url_for('static', filename='images/hero-bg.jpg') }}" alt="Hero Background">
    <div class="image-overlay"></div>
    <div class="hero-content">
      <h1>Ship Sovereign Software</h1>
      <p>Verso Backend is an opinionated Flask + SQL monolith that keeps your auth, content, and scheduling under one roof. No hydration errors. No usage overages. Fixed-cost independence.</p>
    </div>
  </div>
</section>

<div class="small-spacer"></div>

<section class="versatile-apps-section">
  <div class="versatile-container">
    <div class="versatile-text">
      <h2>The Complexity Containment Field</h2>
      <p>One repo. One database. Zero SaaS rent. Verso ships finished truths to the browser and keeps latency inside the box.</p>
      <ul class="versatile-list">
        <li><i class="fas fa-lock"></i> Identity &amp; Access Core: Own your user table and RBAC—no MAU tax.</li>
        <li><i class="fas fa-pen-fancy"></i> Sovereign Narrative Engine: First-party CMS for posts and pages.</li>
        <li><i class="fas fa-calendar"></i> Temporal Logistics Module: Calendar bookings with UTC sanity built in.</li>
        <li><i class="fas fa-database"></i> Single Latency Domain: SQL joins instead of N+1 API calls.</li>
        <li><i class="fas fa-server"></i> Fixed-Cost Hosting: Runs quietly on $5–$20 VPS or on-prem edge boxes.</li>
        <li><i class="fas fa-shield-alt"></i> Air-Gappable: No third-party auth or CMS dependencies required.</li>
      </ul>
    </div>
    <div class="versatile-icons">
      <i class="fas fa-lock icon-social"></i>
      <i class="fas fa-pen-fancy icon-rental"></i>
      <i class="fas fa-calendar icon-appointment"></i>
      <i class="fas fa-database icon-website"></i>
      <i class="fas fa-server icon-auto"></i>
      <i class="fas fa-shield-alt icon-more"></i>
    </div>
  </div>
</section>

<div class="small-spacer"></div>

<section class="gallery-section">
  <h2>Gallery</h2>
  <div class="gallery-container" id="gallery-container">
    <a href="{{ url_for('static', filename='images/gallery/VersoIndustries-Social-Dashboard.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/VersoIndustries-Social-Dashboard.jpg') }}" alt="Verso dashboard screenshot">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/DumpsterDudes.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/DumpsterDudes.jpg') }}" alt="Verso booking experience">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/ZNH-Mockup.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/ZNH-Mockup.jpg') }}" alt="UTC-safe calendar mockup">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/nwauto.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/nwauto.jpg') }}" alt="Inventory landing page">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/Notus-Auto-Sales-Mockup.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/Notus-Auto-Sales-Mockup.jpg') }}" alt="SSR marketing page">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/cprism.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/cprism.jpg') }}" alt="Content engine view">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/GarageCafe-Mockup.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/GarageCafe-Mockup.jpg') }}" alt="Service showcase page">
    </a>
    <a href="{{ url_for('static', filename='images/gallery/rockymtnburial.jpg') }}">
      <img class="lazy" data-src="{{ url_for('static', filename='images/gallery/rockymtnburial.jpg') }}" alt="Static-resilient memorial site">
    </a>
  </div>
  <button id="load-more" data-page="2">Load More</button>
  <div id="lightbox" class="lightbox">
    <span class="lightbox-close">&times;</span>
    <img id="lightbox-img" class="lightbox-img" alt="Gallery Image">
  </div>
</section>

<div class="small-spacer"></div>

<section class="features-section">
  <div class="features-container">
    <h2>Modules of Sovereignty</h2>
    <p>Each module is a subscription you no longer pay for:</p>
    <div class="features-grid">
      <div class="feature-item">
        <i class="fas fa-lock"></i>
        <h3>Identity &amp; Access Core</h3>
        <p>Own your auth table, roles, and decorators. No per-MAU tax.</p>
      </div>
      <div class="feature-item">
        <i class="fas fa-database"></i>
        <h3>SQL Ground Truth</h3>
        <p>Server-side joins keep latency and consistency in one place.</p>
      </div>
      <div class="feature-item">
        <i class="fas fa-file-alt"></i>
        <h3>Sovereign Narrative Engine</h3>
        <p>Publish content with the built-in CMS; marketing moves without SaaS gates.</p>
      </div>
      <div class="feature-item">
        <i class="fas fa-envelope"></i>
        <h3>Signals Not Spam</h3>
        <p>Email hooks for notifications and resets—no external message rent.</p>
      </div>
      <div class="feature-item">
        <i class="fas fa-tachometer-alt"></i>
        <h3>Admin Command</h3>
        <p>Role-aware dashboards for governance without extra dashboards-in-a-box.</p>
      </div>
      <div class="feature-item">
        <i class="fas fa-rocket"></i>
        <h3>Fixed-Cost Deploy</h3>
        <p>Deploy to VPS/Heroku/Dokku or on-prem edge with the same code.</p>
      </div>
      <div class="feature-item">
        <i class="fas fa-puzzle-piece"></i>
        <h3>Bounded Contexts</h3>
        <p>Blueprint modularity without the microservice overhead.</p>
      </div>
    </div>
  </div>
</section>

<div class="small-spacer"></div>

<section class="get-started-section">
  <div class="get-started-container">
    <h2>Declare Independence</h2>
    <p>Spin up the Sovereign Monolith locally:</p>
    <ol class="steps-list">
      <li>Clone the repo.</li>
      <li>Create a virtualenv and install `requirements.txt`.</li>
      <li>Set `.env`, run migrations, seed roles + business config.</li>
      <li>Run `flask run` and ship HTML without hydration roulette.</li>
    </ol>
  </div>
</section>

<div class="small-spacer"></div>

<section class="deploy-section">
  <div class="deploy-container">
    <h2>Deploy Without Rent</h2>
    <p>Choose your sovereignty level:</p>
    <ol class="steps-list">
      <li>Raw VPS with Gunicorn + systemd + Nginx (fixed fee).</li>
      <li>Heroku/Dokku using the provided `Procfile`.</li>
      <li>On-prem/edge for regulated or offline deployments.</li>
    </ol>
  </div>
</section>

<div class="small-spacer"></div>

<section class="frontend-section">
  <div class="frontend-container">
    <div class="frontend-text">
      <h2>Attach Interfaces on Your Terms</h2>
      <p>SSR is default. If you need more:</p>
      <ul class="frontend-list">
        <li>Jinja2 pages for immediate, SEO-friendly delivery.</li>
        <li>API endpoints for React/Vue if you truly need them.</li>
        <li>Designer-friendly handoff; HTML first, no hydration traps.</li>
      </ul>
      <p>Keep state on the server. Keep rent out of the stack.</p>
    </div>
    <div class="frontend-icons">
      <i class="fab fa-html5 icon-jinja"></i>
      <i class="fab fa-react icon-react"></i>
      <i class="fab fa-vuejs icon-vue"></i>
    </div>
  </div>
</section>

<div class="small-spacer"></div>

<section class="community-section">
  <div class="community-container">
    <h2>Adopt the Protocol</h2>
    <p>Use it, fork it, or keep it air-gapped. The prize is sovereignty.</p>
    <ol class="steps-list">
      <li>Fork the monolith.</li>
      <li>Instrument it to your domain.</li>
      <li>Share improvements—zero rent added.</li>
    </ol>
  </div>
</section>

<div class="small-spacer"></div>

<section class="community-section">
  <div class="community-container">
    <h2>Support the Mission</h2>
    <p>If this stack saves you from the Complexity Tax, you can keep it sustainable.</p>
    <a class="btn btn-primary" href="https://github.com/sponsors/versoindustries" target="_blank" rel="noopener">Donate via GitHub Sponsors</a>
  </div>
</section>
{% endblock %}
