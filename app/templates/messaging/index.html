{% extends "base.html" %}

{% block title %}Messaging - Verso{% endblock %}

{% block additional_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/unified-messaging.css') }}">
{% endblock %}

{% block content %}
<div data-react-component="UnifiedMessagingDashboard" data-react-props='{
    "currentUserId": {{ current_user.id }},
    "userRoles": {{ user_roles | tojson | safe if user_roles else "[]" }}
}'></div>

<script>
    // Fallback loading state
    (function () {
        const container = document.querySelector('[data-react-component="UnifiedMessagingDashboard"]');
        if (container && !container.innerHTML.trim()) {
            container.innerHTML = '<div class="unified-messaging loading"><div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i><span>Loading messaging...</span></div></div>';
        }
    })();
</script>
{% endblock %}